<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: Inter, Arial, sans-serif; background:#f6f6fb; margin:0; }
    header { display:flex; justify-content:space-between; align-items:center; padding:18px 24px; background:#111; color:#fff; }
    h1 { font-family:'Playfair Display', serif; font-size:22px; margin:0; }
    .wrap { max-width: 1000px; margin: 24px auto; padding: 0 16px; }
    .card { background:#fff; border-radius:14px; box-shadow: 0 8px 20px rgba(0,0,0,0.05); padding:18px; margin-bottom:20px; }
    label { display:block; font-weight:600; margin-top:10px; }
    input, button { margin-top:6px; padding:11px 12px; border:1px solid #ddd; border-radius:10px; width:100%; max-width:420px; }
    button { background:#111; color:#fff; border:none; cursor:pointer; width:auto; }
    .row { display:flex; flex-wrap:wrap; gap:16px; align-items:flex-start; }
    .qr { max-width:200px; }
    table { width:100%; border-collapse: collapse; }
    th, td { text-align:left; padding:10px; border-bottom:1px solid #eee; font-size:14px; }
    a.btn { display:inline-block; padding:8px 12px; background:#111; color:#fff; border-radius:8px; text-decoration:none; font-size:13px; }
  </style>
</head>
<body>
  <header>
    <h1>📊 Admin Dashboard</h1>
    <div>
      <span>Hi, {{ user }}</span>
      <a href="/logout" class="btn" style="margin-left:10px;">Logout</a>
    </div>
  </header>

  <div class="wrap">
    <div class="card">
      <h3>Create New Event</h3>
      <form method="POST">
        <label>Event Name</label>
        <input type="text" name="event_name" placeholder="e.g., Wedding of Alex & Lina" required>
        <label>Event Date</label>
        <input type="date" name="event_date" required>
        <label>Upload Limit (100–5000)</label>
        <input type="number" name="limit" min="100" max="5000" required>
        <div style="margin-top:12px;">
          <button type="submit">Generate QR & Create</button>
        </div>
      </form>
      {% if created %}
        {% if created.error %}
          <p style="color:#c00; font-weight:600;">{{ created.error }}</p>
        {% else %}
          <div class="row" style="margin-top:16px; align-items:center;">
            <div>
              <p><strong>Event:</strong> {{ created.name }} ({{ created.date }})</p>
              <p><strong>Limit:</strong> {{ created.limit }}</p>
              <p><strong>Upload link:</strong> <a href="{{ created.upload_link }}" target="_blank">{{ created.upload_link }}</a></p>
              <p><a class="btn" href="{{ created.qr_path }}" target="_blank">Open QR Image</a></p>
            </div>
            <img class="qr" src="{{ created.qr_path }}" alt="QR Code">
          </div>
        {% endif %}
      {% endif %}
    </div>

    <div class="card">
      <h3>All Events</h3>
      <table>
        <tr>
          <th>Name</th>
          <th>Date</th>
          <th>Uploaded</th>
          <th>Limit</th>
          <th>Links</th>
        </tr>
        {% for ev in events %}
          <tr>
            <td>{{ ev.name }}</td>
            <td>{{ ev.date }}</td>
            <td>{{ ev.count }}</td>
            <td>{{ ev.limit }}</td>
            <td>
              <a class="btn" href="/upload/{{ ev.event_id }}" target="_blank">Upload Page</a>
              <a class="btn" href="/qr/{{ ev.event_id }}.png" target="_blank">QR</a>
            </td>
          </tr>
        {% endfor %}
      </table>
    </div>
  </div>
</body>
</html>
